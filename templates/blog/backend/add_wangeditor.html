{% extends 'blog/backend/backend_base.html' %}

{% block backendcontent %}
    {% load static %}
    <script src="{% static 'backend/jquery-3.4.1/jquery-3.4.1.min.js' %}"></script>
    <link href="https://unpkg.com/@wangeditor/editor@latest/dist/css/style.css" rel="stylesheet">
    <style>
        #editorâ€”wrapper {
            border: 1px solid #ccc;
            z-index: 100; /* æŒ‰éœ€å®šä¹‰ */
        }

        #toolbar-container {
            border-bottom: 1px solid #ccc;
        }

        #editor-container {
            height: 500px;
        }
    </style>
    <div>
        <p>æ·»åŠ æ–‡ç« </p>
        <div class="form-group">
            <label for="id_name">
                æ–‡ç« æ ‡é¢˜
            </label>
            <input type="text" name="name" id="id_name" class="form-control">
            <p>å†…å®¹ï¼ˆwangeditorç¼–è¾‘å™¨ï¼Œå·²æ”¯æŒä¸Šä¼ å›¾ç‰‡ï¼‰</p>
            <div id="editorâ€”wrapper">
                <div id="toolbar-container"><!-- å·¥å…·æ  --></div>
                <div id="editor-container"><!-- ç¼–è¾‘å™¨ --></div>
            </div>
            <p>
                <button class="btn btn-success">æäº¤</button>
            </p>
        </div>

        <script src="https://unpkg.com/@wangeditor/editor@latest/dist/index.js"></script>
        <script>
            const {createEditor, createToolbar} = window.wangEditor

            editorConfig = {
                MENU_CONF: {
                    server: '/sdfsf/',
                },
                placeholder: 'Type here...',
                onChange(editor) {
                    const html = editor.getHtml()
                    console.log('editor content', html)
                    // ä¹Ÿå¯ä»¥åŒæ­¥åˆ° <textarea>
                },
            }
            toolbarConfig = {}

            // ä¿®æ”¹ uploadImage èœå•é…ç½®
            editorConfig.MENU_CONF['uploadImage'] = {
                server: '/upload_img/',
                fieldName: 'custom-field-name'
                // ç»§ç»­å†™å…¶ä»–é…ç½®...

                //ã€æ³¨æ„ã€‘ä¸éœ€è¦ä¿®æ”¹çš„ä¸ç”¨å†™ï¼ŒwangEditor ä¼šå» merge å½“å‰å…¶ä»–é…ç½®
            }

            // ä¿®æ”¹ otherMenuKey èœå•é…ç½®
            editorConfig.MENU_CONF['otherMenuKey'] = {
                // é…ç½®
            }
            // æ–‡å­—é¢œè‰²
            editorConfig.MENU_CONF['color'] = {
                colors: ['#000', '#333', '#666']
            }

            // èƒŒæ™¯è‰²
            editorConfig.MENU_CONF['bgColor'] = {
                colors: ['#000', '#333', '#666']
            }
            editorConfig.MENU_CONF['fontSize'] = {
                fontSizeList: [
                    // å…ƒç´ æ”¯æŒä¸¤ç§å½¢å¼
                    //   1. å­—ç¬¦ä¸²ï¼›
                    //   2. { name: 'xxx', value: 'xxx' }

                    '12px',
                    '16px',
                    {name: '24px', value: '24px'},
                    '40px',
                ]
            }
            editorConfig.MENU_CONF['lineHeight'] = {
                lineHeightList: ['1', '1.5', '2', '2.5']
            }
            editorConfig.MENU_CONF['emotion'] = {
                emotions: 'ğŸ˜€ ğŸ˜ƒ ğŸ˜„ ğŸ˜ ğŸ˜† ğŸ˜… ğŸ˜‚ ğŸ¤£ ğŸ˜Š ğŸ˜‡ ğŸ™‚ ğŸ™ƒ ğŸ˜‰'.split(' ') // æ•°ç»„
            }

            // è‡ªå®šä¹‰æ ¡éªŒé“¾æ¥
            // function customCheckLinkFn(text: string, url: string): string | boolean | undefined {   // TS è¯­æ³•
            function customCheckLinkFn(text, url) {                                              // JS è¯­æ³•

                if (!url) {
                    return
                }
                if (url.indexOf('http') !== 0) {
                    return 'é“¾æ¥å¿…é¡»ä»¥ http/https å¼€å¤´'
                }
                return true

                // è¿”å›å€¼æœ‰ä¸‰ç§é€‰æ‹©ï¼š
                // 1. è¿”å› true ï¼Œè¯´æ˜æ£€æŸ¥é€šè¿‡ï¼Œç¼–è¾‘å™¨å°†æ­£å¸¸æ’å…¥é“¾æ¥
                // 2. è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯´æ˜æ£€æŸ¥æœªé€šè¿‡ï¼Œç¼–è¾‘å™¨ä¼šé˜»æ­¢æ’å…¥ã€‚ä¼š alert å‡ºé”™è¯¯ä¿¡æ¯ï¼ˆå³è¿”å›çš„å­—ç¬¦ä¸²ï¼‰
                // 3. è¿”å› undefinedï¼ˆå³æ²¡æœ‰ä»»ä½•è¿”å›ï¼‰ï¼Œè¯´æ˜æ£€æŸ¥æœªé€šè¿‡ï¼Œç¼–è¾‘å™¨ä¼šé˜»æ­¢æ’å…¥ã€‚ä½†ä¸ä¼šæç¤ºä»»ä½•ä¿¡æ¯
            }

            // è‡ªå®šä¹‰è½¬æ¢é“¾æ¥ url
            // function customParseLinkUrl(url: string): string {   // TS è¯­æ³•
            function customParseLinkUrl(url) {                // JS è¯­æ³•

                if (url.indexOf('http') !== 0) {
                    return `http://${url}`
                }
                return url
            }

            // æ’å…¥é“¾æ¥
            editorConfig.MENU_CONF['insertLink'] = {
                checkLink: customCheckLinkFn, // ä¹Ÿæ”¯æŒ async å‡½æ•°
                parseLinkUrl: customParseLinkUrl, // ä¹Ÿæ”¯æŒ async å‡½æ•°
            }
            // æ›´æ–°é“¾æ¥
            editorConfig.MENU_CONF['editLink'] = {
                checkLink: customCheckLinkFn, // ä¹Ÿæ”¯æŒ async å‡½æ•°
                parseLinkUrl: customParseLinkUrl, // ä¹Ÿæ”¯æŒ async å‡½æ•°
            }

            {#è¿™ä¸‹é¢çš„ä¸¤ä¸ªæ˜¯åˆå§‹åŒ–ï¼Œå¿…é¡»æ”¾åœ¨æœ€ä¸‹é¢ï¼Œä¸Šé¢è¿›è¡Œç›¸å…³çš„é…ç½®#}
            // ç¼–è¾‘æ 
            editor = createEditor({
                selector: '#editor-container',
                html: '<p><br></p>',
                config: editorConfig,
                mode: 'default', // or 'simple'
            })
            // å·¥å…·æ 
            toolbar = createToolbar({
                editor,
                selector: '#toolbar-container',
                config: toolbarConfig,
                mode: 'default', // or 'simple'
            })
        </script>

    </div>
{% endblock backendcontent %}